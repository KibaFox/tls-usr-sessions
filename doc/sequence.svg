<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="799px" preserveAspectRatio="none" style="width:687px;height:799px;" version="1.1" viewBox="0 0 687 799" width="687px" zoomAndPan="magnify"><defs><filter height="300%" id="f15zux9wyzbkoi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="354" x="162" y="22.9951">TLS User Sessions w/ Mutual Auth Sequence</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="27" x2="27" y1="116.5938" y2="711.9844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="182.5" x2="182.5" y1="116.5938" y2="711.9844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="404" x2="404" y1="116.5938" y2="711.9844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="558" x2="558" y1="116.5938" y2="711.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="113.292">User</text><ellipse cx="27" cy="43.2969" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,51.2969 L27,78.2969 M14,59.2969 L40,59.2969 M27,78.2969 L14,93.2969 M27,78.2969 L40,93.2969 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="723.9795">User</text><ellipse cx="27" cy="737.2813" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,745.2813 L27,772.2813 M14,753.2813 L40,753.2813 M27,772.2813 L14,787.2813 M27,772.2813 L40,787.2813 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="160.5" y="113.292">Client</text><ellipse cx="183" cy="84.2969" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="171" x2="195" y1="98.2969" y2="98.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="160.5" y="723.9795">Client</text><ellipse cx="183" cy="743.2813" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="171" x2="195" y1="757.2813" y2="757.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="324" y="96.9951">Authentication Service</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="362" y="113.292">(port 4443)</text><path d="M383.5,56 L383.5,80 M383.5,68 L400.5,68 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="412.5" cy="68" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="324" y="723.9795">Authentication Service</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="362" y="740.2764">(port 4443)</text><path d="M383.5,747.5781 L383.5,771.5781 M383.5,759.5781 L400.5,759.5781 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="412.5" cy="759.5781" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="494" y="96.9951">Protected Service</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="516" y="113.292">(port 4444)</text><path d="M537.5,56 L537.5,80 M537.5,68 L554.5,68 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="566.5" cy="68" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="494" y="723.9795">Protected Service</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="516" y="740.2764">(port 4444)</text><path d="M537.5,747.5781 L537.5,771.5781 M537.5,759.5781 L554.5,759.5781 " fill="none" filter="url(#f15zux9wyzbkoi)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="566.5" cy="759.5781" fill="#FEFECE" filter="url(#f15zux9wyzbkoi)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#EEEEEE" filter="url(#f15zux9wyzbkoi)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="672" x="3" y="147.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="675" y1="147.1602" y2="147.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="675" y1="150.1602" y2="150.1602"/><rect fill="#EEEEEE" filter="url(#f15zux9wyzbkoi)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="59" x="309.5" y="136.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="315.5" y="152.6606">Login</text><polygon fill="#A80036" points="171,186.8594,181,190.8594,171,194.8594,175,190.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="177" y1="190.8594" y2="190.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="34" y="185.7935">Login w/ user + pass</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="225" y1="219.9922" y2="219.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="225" x2="225" y1="219.9922" y2="232.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="225" y1="232.9922" y2="232.9922"/><polygon fill="#A80036" points="194,228.9922,184,232.9922,194,236.9922,190,232.9922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="190" y="214.9263">Generate key + CSR</text><polygon fill="#A80036" points="392,273.2578,402,277.2578,392,281.2578,396,277.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="398" y1="277.2578" y2="277.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="190" y="257.0591">Request Login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="190" y="272.1919">user + pass + CSR</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="404" x2="446" y1="306.3906" y2="306.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="446" x2="446" y1="306.3906" y2="319.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="446" y1="319.3906" y2="319.3906"/><polygon fill="#A80036" points="415,315.3906,405,319.3906,415,323.3906,411,319.3906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="411" y="301.3247">Verify login</text><polygon fill="#A80036" points="194,344.5234,184,348.5234,194,352.5234,190,348.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="188" x2="403" y1="348.5234" y2="348.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="200" y="343.4575">Signed client cert + issuer cert</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="225" y1="377.6563" y2="377.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="225" x2="225" y1="377.6563" y2="390.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="225" y1="390.6563" y2="390.6563"/><polygon fill="#A80036" points="194,386.6563,184,390.6563,194,394.6563,190,390.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="190" y="372.5903">Save client + issuer cert</text><polygon fill="#A80036" points="38,415.7891,28,419.7891,38,423.7891,34,419.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="182" y1="419.7891" y2="419.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="44" y="414.7231">Login successful</text><rect fill="#EEEEEE" filter="url(#f15zux9wyzbkoi)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="672" x="3" y="448.3555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="675" y1="448.3555" y2="448.3555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="675" y1="451.3555" y2="451.3555"/><rect fill="#EEEEEE" filter="url(#f15zux9wyzbkoi)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="113" x="282.5" y="437.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="288.5" y="453.856">User Session</text><polygon fill="#A80036" points="171,488.0547,181,492.0547,171,496.0547,175,492.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="177" y1="492.0547" y2="492.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="34" y="486.9888">Get MOTD</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="225" y1="536.3203" y2="536.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="225" x2="225" y1="536.3203" y2="549.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="225" y1="549.3203" y2="549.3203"/><polygon fill="#A80036" points="194,545.3203,184,549.3203,194,553.3203,190,549.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="190" y="516.1216">Load client cert</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="190" y="531.2544">from login</text><polygon fill="#A80036" points="546,589.5859,556,593.5859,546,597.5859,550,593.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="183" x2="552" y1="593.5859" y2="593.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="190" y="573.3872">Connect w/ TLS mutual auth</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="190" y="588.52">Request MOTD</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="558" x2="600" y1="622.7188" y2="622.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="600" x2="600" y1="622.7188" y2="635.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="559" x2="600" y1="635.7188" y2="635.7188"/><polygon fill="#A80036" points="569,631.7188,559,635.7188,569,639.7188,565,635.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="565" y="617.6528">Verify client cert</text><polygon fill="#A80036" points="194,660.8516,184,664.8516,194,668.8516,190,664.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="188" x2="557" y1="664.8516" y2="664.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="200" y="659.7856">MOTD response</text><polygon fill="#A80036" points="38,689.9844,28,693.9844,38,697.9844,34,693.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="182" y1="693.9844" y2="693.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="44" y="688.9185">MOTD</text><!--
@startuml
title TLS User Sessions w/ Mutual Auth Sequence

actor User as usr
entity "Client" as cli
boundary "Authentication Service\n(port 4443)" as auth
boundary "Protected Service\n(port 4444)" as protected

== Login ==

usr -> cli : Login w/ user + pass
cli -> cli : Generate key + CSR
cli -> auth : Request Login\nuser + pass + CSR
auth -> auth : Verify login
auth -> cli : Signed client cert + issuer cert
cli -> cli : Save client + issuer cert
cli -> usr : Login successful

== User Session ==

usr -> cli : Get MOTD
cli -> cli : Load client cert\nfrom login
cli -> protected : Connect w/ TLS mutual auth\nRequest MOTD
protected -> protected : Verify client cert
protected -> cli : MOTD response
cli -> usr : MOTD

@enduml

PlantUML version 1.2018.13(Mon Nov 26 12:11:51 EST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.3+7-Ubuntu-1ubuntu219.04.1
Operating System: Linux
OS Version: 5.0.0-15-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>